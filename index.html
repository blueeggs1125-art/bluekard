<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" sizes="16x16" href="icon/16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icon/32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="icon/48x48.png">
    <link rel="icon" type="image/png" sizes="64x64" href="icon/64x64.png">
    <link rel="icon" type="image/png" sizes="128x128" href="icon/128x128.png">
    <link rel="icon" type="image/png" sizes="256x256" href="icon/256x256.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon/512x512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icon/180x180.png">
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FUCK 1939</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            padding: 10px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
            font-size: 24px;
        }
        
        .selector-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        select {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            background-color: white;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .image-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        
        .image-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            background-color: white;
            aspect-ratio: 2/3; 
        }
        
        .image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .image-item .image-name {
            padding: 5px;
            font-size: 11px;
            text-align: center;
            background-color: rgba(0,0,0,0.8);
            color: white;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .no-images {
            text-align: center;
            padding: 40px 20px;
            color: #999;
            font-style: italic;
            grid-column: 1 / -1;
        }
        
        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            grid-column: 1 / -1;
        }
        
        /* 添加导航链接样式 */
        .nav-link {
            display: block;
            text-align: center;
            margin: 15px 0;
            color: #1e90ff;
            text-decoration: none;
            font-weight: bold;
        }
        
        .nav-link:hover {
            text-decoration: underline;
        }
        
        /* 上下文菜单样式 */
        .context-menu {
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            min-width: 120px;
        }
        
        .context-menu-item {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .context-menu-item:hover {
            background-color: #f0f0f0;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 10px;
            }
            
            .image-container {
                grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
                gap: 8px;
            }
            
            h1 {
                font-size: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .image-container {
                grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
                gap: 5px;
            }
            
            .image-item .image-name {
                font-size: 8px;
                padding: 2px;
            }
        }
    </style>
</head>
<body>
    <a href="https://space.bilibili.com/596035099" target="_blank" style="display: block; text-align: center; margin-top: 20px; color: #1e90ff; text-decoration: none;">blueeggs</a>
    <div class="container">
        <h1>KARDS素材库</h1>
        <h2>最后提交时间：2025/8/28 12:22</h2>
        
        <!-- 添加跳转到音效页面的链接 -->
        <a href="suck.html" class="nav-link">前往音效库</a>
        
        <div class="selector-group">
            <label for="country-select">选择国家/类型:</label>
            <select id="country-select">
                <option value="">请选择...</option>
                <option value="苏联">苏联</option>
                <option value="美国">美国</option>
                <option value="德国">德国</option>
                <option value="日本">日本</option>
                <option value="英国">英国</option>
                <option value="波兰">波兰</option>
                <option value="法国">法国</option>
                <option value="意大利">意大利</option>
                <option value="芬兰">芬兰</option>
                <option value="总部">总部</option>
                <option value="卡背">卡背</option>
            </select>
        </div>
        
        <div class="selector-group" id="subtype-group" style="display: none;">
            <label for="subtype-select">选择卡牌类型:</label>
            <select id="subtype-select">
                <option value="">请选择...</option>
            </select>
        </div>
        
        <div id="image-display">
            <div class="no-images">请先选择国家/类型</div>
        </div>
    </div>

    <script src="js/image.js"></script>
    

<script>
    const countries = {
        '苏联': { name: '苏联', hasSubtypes: true },
        '美国': { name: '美国', hasSubtypes: true },
        '德国': { name: '德国', hasSubtypes: true },
        '日本': { name: '日本', hasSubtypes: true },
        '英国': { name: '英国', hasSubtypes: true },
        '波兰': { name: '波兰', hasSubtypes: true },
        '法国': { name: '法国', hasSubtypes: true },
        '意大利': { name: '意大利', hasSubtypes: true },
        '芬兰': { name: '芬兰', hasSubtypes: true },
        '总部': { name: '总部', hasSubtypes: false },
        '卡背': { name: '卡背', hasSubtypes: false }
    };
    
    const subtypes = {
        '金卡': '金卡',
        '银卡': '银卡',
        '铜卡': '铜卡',
        '铁卡': '铁卡'
    };
    
    const noGoldCountries = ['波兰', '法国', '意大利', '芬兰'];
    
    const countrySelect = document.getElementById('country-select');
    const subtypeGroup = document.getElementById('subtype-group');
    const subtypeSelect = document.getElementById('subtype-select');
    const imageDisplay = document.getElementById('image-display');
    
    countrySelect.addEventListener('change', function() {
        const country = this.value;
        if (!country) {
            subtypeGroup.style.display = 'none';
            imageDisplay.innerHTML = '<div class="no-images">请先选择国家/类型</div>';
            return;
        }
        
        const countryConfig = countries[country];
        if (countryConfig.hasSubtypes) {
            subtypeGroup.style.display = 'block';
            updateSubtypeOptions(country);
            imageDisplay.innerHTML = '<div class="no-images">请选择卡牌类型</div>';
        } else {
            subtypeGroup.style.display = 'none';
            displayImages(country);
        }
    });
    
    subtypeSelect.addEventListener('change', function() {
        const country = countrySelect.value;
        const subtype = this.value;
        if (country && subtype) {
            displayImages(country, subtype);
        } else {
            imageDisplay.innerHTML = '<div class="no-images">请选择卡牌类型</div>';
        }
    });
    
    function updateSubtypeOptions(country) {
        subtypeSelect.innerHTML = '<option value="">请选择...</option>';
        
        for (const [key, name] of Object.entries(subtypes)) {
            if (key === '金卡' && noGoldCountries.includes(country)) {
                continue;
            }
            const option = document.createElement('option');
            option.value = key;
            option.textContent = name;
            subtypeSelect.appendChild(option);
        }
    }
    
    async function displayImages(country, subtype = null) {
        imageDisplay.innerHTML = '<div class="loading">加载中...</div>';
        
        try {
            const images = await getImagesForCountry(country, subtype);
            
            if (images.length === 0) {
                imageDisplay.innerHTML = '<div class="no-images">该分类下暂无图片</div>';
                return;
            }
            
            const pngImages = images.filter(image => 
                image.toLowerCase().endsWith('.png')
            );
            
            if (pngImages.length === 0) {
                imageDisplay.innerHTML = '<div class="no-images">该分类下暂无PNG图片</div>';
                return;
            }
            
            let html = '<div class="image-container">';
            pngImages.forEach(image => {
                const fileName = image.split('/').pop();
                html += `
                    <div class="image-item">
                        <img src="${image}" alt="${fileName}" 
                             oncontextmenu="downloadImage(event, '${image}', '${fileName}')"
                             ontouchstart="handleTouchStart(event, '${image}', '${fileName}')"
                             ontouchend="handleTouchEnd()"
                             ontouchmove="handleTouchMove(event)">
                        <div class="image-name">${fileName}</div>
                    </div>
                `;
            });
            html += '</div>';
            
            imageDisplay.innerHTML = html;
            
        } catch (error) {
            console.error('加载图片出错:', error);
            imageDisplay.innerHTML = '<div class="no-images">加载图片失败</div>';
        }
    }
    
    // 触摸事件处理变量
    let touchStartTime;
    let touchTimer;
    let touchHandled = false;
    
    // 触摸开始事件
    function handleTouchStart(event, url, filename) {
        touchStartTime = Date.now();
        touchHandled = false;
        clearTimeout(touchTimer);
        
        // 长按800ms后触发下载
        touchTimer = setTimeout(() => {
            if (!touchHandled) {
                downloadImage(event, url, filename);
                touchHandled = true;
            }
        }, 800);
        
        event.preventDefault();
    }
    
    // 触摸移动事件
    function handleTouchMove(event) {
        // 如果用户移动手指，取消长按下载
        clearTimeout(touchTimer);
        touchHandled = true;
    }
    
    // 触摸结束事件
    function handleTouchEnd() {
        // 如果用户提前结束触摸，取消长按下载
        clearTimeout(touchTimer);
        touchHandled = true;
    }
    
    // 下载图片
    function downloadImage(event, url, filename) {
        event.preventDefault();
        
        const link = document.createElement('a');
        link.href = url;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
</script>
</body>

</html>

